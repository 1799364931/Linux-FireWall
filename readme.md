# Linux 个人防火墙

## 1 实现功能

### 1.1 安全规则

+ 基于IP的过滤：根据源IP或目标IP地址进行过滤。
+ 基于端口的过滤：针对TCP和UDP，根据源端口或目标端口进行过滤。
+ 基于协议的过滤：根据IP协议类型进行过滤。
+ 基于MAC地址的过滤：根据源MAC或目标MAC地址进行过滤（通常只在局域网内有效）。
+ 基于包状态的过滤（状态防火墙）：例如，只允许已建立连接的数据包通过。
+ 基于数据包内容的过滤（深度包检测）：检查数据包负载中的特定字符串或模式。
+ 基于时间段的过滤：在特定时间段内启用或禁用规则。
+ 基于网络接口的过滤：根据数据包进入或离开的网络接口进行过滤。
+ 流量限制（限速）：限制某个IP或端口的流量速率。
+ 日志记录：对匹配规则的数据包进行日志记录。

## 2 框架设计

### 2.1 安全规则设计
利用`netfilter`库对挂载点进行`hook function`挂载，利用挂载链实现挂载过滤函数复用和逻辑拆分。

#### 2.1.1 PRE_ROUTING
+ IP 过滤
+ 基础协议过滤
+ 流量速率限制

#### 2.1.2 LOCAL_IN
+ 端口访问规则
+ 连接状态管理
+ 应用层协议过滤
+ IP 过滤
+ 基础协议过滤
+ 流量速率限制

